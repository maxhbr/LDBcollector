<!--
SPDX-FileCopyrightText: 2021 Hermine-team <hermine@inno3.fr>
SPDX-FileCopyrightText: 2022 Martin Delabre <gitlab.com/delabre.martin>

SPDX-License-Identifier: AGPL-3.0-only -->

{% extends "cube/cube.html" %}
{% block title %}Products{% endblock %}
{% block breadcrumbs %}
<ul>
  <li>Hermine</li>
  <li>Products</li>
</ul>
{% endblock %}
{% block actions %}
<a class="button is-info is-inverted" href="/admin/cube/product/add/" target="_blank">
            <span class="icon">
              <i class="fas fa-plus"></i>
            </span>
            <span>Create a new product</span>
          </a>
{% endblock %}
{% block herozone %}
<h1 class="title">
  <span class="icon is-medium"><i class="fas fa-cubes"></i></span>
  Your Products
</h1>
{% endblock %}

{% block content %}
  <div class="tile is-ancestor">
    <div class="tile is-parent">
      <div class="card tile is-child">
        <div class="card-content">
          <div class="level is-mobile">
            <div class="level-item">
              <div class="is-widget-label"><h3 class="subtitle is-spaced">
                Products
              </h3>
                <h1 class="title">
                  {{ nb_products }}
                </h1>
              </div>
            </div>
            <div class="level-item has-widget-icon">
              <div class="is-widget-icon"><span class="icon has-text-primary is-large"><i class="fas fa-cubes fa-2x"></i></span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
      <div class="tile is-parent">
        <div class="card tile is-child">
          <div class="card-content">
            <div class="level is-mobile">
              <div class="level-item">
                <div class="is-widget-label"><h3 class="subtitle is-spaced">
                  Releases
                </h3>
                  <h1 class="title">
                    {{ nb_releases }}
                  </h1>
                </div>
              </div>
              <div class="level-item has-widget-icon">
                <div class="is-widget-icon"><span class="icon has-text-primary is-large"><i class="fas fa-code-branch fa-2x"></i></span>
                </div>
              </div>
            </div>
          </div>
      </div>
    </div>
  </div>
<table class="table is-striped is-hoverable is-fullwidth">
  <thead>
    <tr>
      <th>Product</th>
      <th>Categories</th>
      <th>Description</th>
      <th>Owner</th>
      <th># of releases</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
{% for product in object_list %}
    <tr>
      <td><a href="{% url 'cube:product_detail' product.id %}">{{product.name}}</a></td>
      <td> {% for category in product.category_set.all %} <span class="tag is-dark">{{ category }}</span> {% endfor %}</td>
      <td> {{ product.description|truncatechars:50 }}</td>
      <td>{{product.owner}}</td>
      <td>{{product.releases.all|length}}</td>
      <td><a href="{% url 'cube:product_detail' product.id %}"><i class="fas fa-info-circle"></i></a> |
        <a href="/admin/cube/product/{{product.id}}" target="_blank"><i class="far fa-edit"></i></a></td>
    </tr>
  </a>
{% endfor %}
</tbody>
</table>

<div class="pagination">
  <span class="step-links">
  {% if page_obj.has_previous %}
    <a href="?page=1"><span class="current button is-link">1</span></a>
    <a href="?page={{ page_obj.previous_page_number }}"><span class="current button is-link is-light">previous</span></a>
  {% endif %}
  <span class="current button is-primary">
  Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}.
  </span>
  {% if page_obj.has_next %}
    <a href="?page={{ page_obj.next_page_number }}"><span class="current button is-link is-light">next</span></a>
    <a href="?page={{ page_obj.paginator.num_pages }}"><span class="current button is-link">{{page_obj.paginator.num_pages}}</span></a>
  {% endif %}
  </span>
</div>

{% endblock %}


