Portions of this code are copied from the Go source code, which is licensed under the following terms.