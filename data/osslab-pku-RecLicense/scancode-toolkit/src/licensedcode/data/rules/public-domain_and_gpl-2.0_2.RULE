copied from libtomcrypt and then relicensed under GPLv2