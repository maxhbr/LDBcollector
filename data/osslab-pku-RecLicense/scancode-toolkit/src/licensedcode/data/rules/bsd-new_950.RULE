routines are under the modified BSD license: