Modifications to public domain implementation