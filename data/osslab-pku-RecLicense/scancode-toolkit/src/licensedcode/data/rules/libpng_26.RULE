Parts of this software have been adapted from the libpng package.