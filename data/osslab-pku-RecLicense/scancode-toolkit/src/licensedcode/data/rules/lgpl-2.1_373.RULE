code is under GNU LGPLv2.1