taken from libjpeg, see the top of the files for licensing details.