based on the code in libgcrypt, copyright owned by the Free Software Foundation