For usage conditions, see lib_rand.c