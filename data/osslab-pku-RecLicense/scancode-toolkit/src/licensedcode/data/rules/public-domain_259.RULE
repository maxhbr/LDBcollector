Portions of this code are derived from classes placed in the public domain