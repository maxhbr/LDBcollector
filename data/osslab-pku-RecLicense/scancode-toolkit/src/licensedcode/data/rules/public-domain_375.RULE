originally written by Mark Adler who submitted it as public domain code.