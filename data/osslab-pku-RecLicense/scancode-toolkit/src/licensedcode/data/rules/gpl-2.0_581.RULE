based on GPL'ed 2.6 kernel sources