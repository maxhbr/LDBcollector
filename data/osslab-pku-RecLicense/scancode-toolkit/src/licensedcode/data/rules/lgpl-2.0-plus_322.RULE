This code is distributed under the GNU LGPL license.