Derived from Public domain C code
