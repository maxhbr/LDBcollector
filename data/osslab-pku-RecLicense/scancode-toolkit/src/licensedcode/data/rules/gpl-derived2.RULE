Derived from code originally in linux/arch/arm/kernel/fiq.c