taken from the original NTT provided GPL source.