Based on a public domain implementation